let myCanvas = document.getElementById("myCanvas")

let Width = window.innerWidth
let Height = window.innerHeight
myCanvas.style.top = 0
myCanvas.style.left = 0
myCanvas.width = Width
myCanvas.height = Height
myCanvas.style.position = "absolute"

let CTX = {"main":myCanvas.getContext("2d")}
let ctx = CTX.main

let mouseX = 0
let mouseY = 0

onmousemove = (e)=>{mouseX = (e.clientX); mouseY = (e.clientY)}

let auds = {
	"1":"./music/Note1.mp3",
	"2":"./music/Note2.mp3",
	"3":"./music/Note3.mp3",
	"4":"./music/Note4.mp3",
	"5":"./music/Note5.mp3",
	"6":"./music/Note6.mp3",
	"7":"./music/7.mp3",
	"8":"./music/8.mp3",
	"9":"./music/9.mp3",
	"10":"./music/10.mp3",
	"11":"./music/11.mp3",
	"12":"./music/12.mp3",
	"13":"./music/13.mp3",
	"14":"./music/14.mp3",
	"15":"./music/15.mp3",
	"16":"./music/16.mp3",
	"17":"./music/17.mp3",
	"18":"./music/18.mp3",
	"19":"./music/19.mp3",
	"20":"./music/20.mp3",
	"21":"./music/21.mp3",
	"22":"./music/22.mp3",
	"23":"./music/23.mp3",
	"24":"./music/24.mp3",
	"25":"./music/25.mp3",
	"26":"./music/26.mp3",
	"27":"./music/27.mp3",
	"28":"./music/28.mp3",
	"29":"./music/29.mp3",
	"30":"./music/30.mp3",
	"31":"./music/31.mp3",
	"32":"./music/32.mp3",
	"33":"./music/33.mp3",
	"34":"./music/34.mp3",
	"35":"./music/35.mp3",
	"36":"./music/36.mp3",
	"37":"./music/37.mp3",
	"38":"./music/38.mp3",
	"39":"./music/39.mp3",
	"R18":"./music/R18.mp3",
}


let song1 = {
	"info":{"repeat":256},
	"0":{
		"0":[29,17],
		"4":[21],
		"6":[24],
		"8":[17],
		"12":[21]
	},
	"1":{
		"0":[31,17],
		"2":[33],
		"4":[21],
		"6":[29],
		"8":[17],
		"10":[24],
		"12":[21]
	},
	"2":{
		"0":[27,13],
		"4":[17],
		"6":[25],
		"8":[19],
		"12":[20]
	},
	"3":{
		"0":[19],
		"4":[17],
		"8":[13],
		"12":[12,24]
	},
	"4":{
		"0":[29,17],
		"4":[21],
		"6":[24],
		"8":[17],
		"12":[21]
	},
	"5":{
		"0":[31,17],
		"2":[33],
		"4":[21],
		"6":[29],
		"8":[17],
		"10":[24],
		"12":[21]
	},
	"6":{
		"0":[27,13],
		"4":[17],
		"6":[25],
		"8":[19],
		"12":[20]
	},
	"7":{
		"0":[19,22],
		"4":[17,24],
		"8":[13,25],
		"12":[12,27]
	},
	"8":{
		"0":[29,10],
		"4":[13],
		"6":[25],
		"8":[20],
		"12":[13]
	},
	"9":{
		"0":[29,10],
		"2":[31],
		"4":[12],
		"6":[27],
		"8":[16],
		"10":[22],
		"12":[12]
	},
	"10":{
		"0":[24,5],
		"4":[8],
		"8":[12],
		"12":[17],
		"14":[20]
	},
	"11":{
		"0":[29,5],
		"4":[8],
		"8":[12],
		"12":[17]
	},
	"12":{
		"0":[25,10],
		"4":[13],
		"8":[32,20],
		"12":[13],
		"14":[29]
	},
	"13":{
		"0":[31,12],
		"4":[16],
		"8":[19],
		"12":[28,24]
	},
	"14":{
		"0":[29,5],
		"4":[8],
		"8":[12],
		"12":[17]
	},
	"15":{
		"0":[17],
		"4":[19],
		"8":[20],
		"12":[24]
	}
}

//C 1,13,25,37 :E 5,17,29 : F 6,18,30 : G 8,20,32 : A 10,22,34

let song2 = {
	"info":{"repeat":256},
	"0":{
		"0":[13,37],
		"2":[20],
		"4":[24,37],
		"6":[25],
		"8":[36],
		"10":[20,36],
		"12":[24],
		"14":[25]
	},
	"1":{
		"0":[13,32],
		"2":[20],
		"4":[24],
		"6":[25],
		"8":[27],
		"10":[29],
		"12":[25],
		"14":[20]
	},
	"2":{
		"0":[13,37],
		"2":[20],
		"4":[24,37],
		"6":[25,36],
		"10":[20,36],
		"12":[24],
		"14":[25]
	},
	"3":{
		"0":[13,32],
		"2":[20],
		"4":[24],
		"6":[25],
		"8":[27],
		"10":[29],
		"12":[25],
		"14":[20]
	},
	"4":{
		"0":[10,37],
		"2":[17],
		"4":[24,37],
		"6":[25],
		"8":[36],
		"10":[17,36],
		"12":[24],
		"14":[25]
	},
	"5":{
		"0":[10,34],
		"2":[17],
		"4":[24],
		"6":[25],
		"8":[27],
		"10":[29],
		"12":[25],
		"14":[24]
	},
	"6":{
		"0":[10,37],
		"2":[17],
		"4":[24,37],
		"6":[25,36],
		"10":[17,36],
		"12":[24],
		"14":[25]
	},
	"7":{
		"0":[10,34],
		"2":[17],
		"4":[24],
		"6":[25],
		"8":[27],
		"10":[29],
		"12":[25],
		"14":[22]
	},
	"8":{
		"0":[6,34],
		"2":[13],
		"4":[18,34],
		"6":[22],
		"8":[32],
		"10":[13,32],
		"12":[18],
		"14":[22]
	},
	"9":{
		"0":[6,30],
		"2":[13],
		"4":[18],
		"6":[22],
		"8":[20],
		"10":[22],
		"12":[20],
		"14":[13]
	},
	"10":{
		"0":[6,34],
		"2":[13],
		"4":[18,34],
		"6":[22,32],
		"10":[13,32],
		"12":[20],
		"14":[22]
	},
	"11":{
		"0":[6,30],
		"2":[13],
		"4":[18],
		"6":[22],
		"8":[20,25],
		"10":[22,30],
		"12":[20,15],
		"14":[13]
	},
	"12":{
		"0":[8,36],
		"2":[15],
		"4":[20,36],
		"6":[24],
		"8":[34],
		"10":[15,34],
		"12":[20],
		"14":[24]
	},
	"13":{
		"0":[8,32],
		"2":[15],
		"4":[20],
		"6":[24],
		"10":[15],
		"12":[20],
		"14":[24]
	},
	"14":{
		"0":[8,36],
		"2":[15],
		"4":[20,36],
		"6":[24,34],
		"10":[15],
		"12":[20,34],
		"14":[24]
	},
	"15":{
		"0":[8,32],
		"2":[15],
		"4":[20],
		"6":[24],
		"8":[27],
		"10":[15,32],
		"12":[20,27],
		"14":[24]
	}
}
//C 1,13,25,37 :E 5,17,29 : F 6,18,30 : G 8,20,32 : A 10,22,34
let currentAud = [0,0]


function playSound(s){
	currentAud[1] = new Audio(auds[s])
	currentAud[1].play()
}



class song{
	static intervalTime = 12000/7/4/4
	static interval = 0
	static counter = -1
	static currentSong = song2

	static repeat(){
		this.counter += 1
		let A = this.counter%this.currentSong.info.repeat
		let b = A%16
		let a = Math.floor(A/16)
		// console.log(a,b)

		if(this.currentSong[a] == undefined){return}

		let arr = this.currentSong[a][b]
		if(arr == undefined){return}
		arr.forEach((e)=>{
			playSound(e)
		})

		
	}
	static start(){
		this.interval = setInterval(()=>{this.repeat()},this.intervalTime)
	}

	static changeSong(s){
		this.currentSong = s
		this.counter = -1
	}

}








function playForce(a,s){
	playSound(s)
	currentAud[0] = a
}

let interval = setInterval(()=>{

	if(currentAud[0] > 0){
		currentAud[0] -= 1

		if(currentAud[0] > 50){
			currentAud[1].playbackRate = 1
		}else {
			currentAud[1].playbackRate = (currentAud[0]/50)*0.4+0.6
		}

	} else {
		if(currentAud[1] !== 0){
		currentAud[1].pause()
	}
	}

},100)

setTimeout(()=>{song.start()},1000)
